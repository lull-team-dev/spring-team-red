<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>宿泊先一覧</title>
</head>
<body>
	<div th:replace="~{header :: header}"></div>
	<h1>Derntel.com(仮)</h1>
	<form action="/hotel/search" method="get">
	<table border="1">
		<tr>
			<th>エリア</th>
			<td>
				<select name="pref">
					<th:block th:each="prefecture : ${prefLabel}">
						<option th:value="${prefecture.label}" th:text="${prefecture.label}" th:selected="${prefecture.label == pref}"></option>
					</th:block>
				</select>
			</td>
		</tr>
		<tr>
			<th>チェックイン/チェックアウト</th>
			<td>
				<input type="date" name="checkIn" th:value="${checkIn}" id="checkIn" required>
				〜
				<input type="date" name="checkOut" th:value="${checkOut}" id="checkOut" required>
			</td>
		</tr>
		<tr>
			<th>人数</th>
			<td>
				<select name="numberOfPeople" th:value="${numberOfPeople}">
					<option value="1" th:selected="${numberOfPeople == 1}">1</option>
					<option value="2" th:selected="${numberOfPeople == 2}">2</option>
					<option value="3" th:selected="${numberOfPeople == 3}">3</option>
					<option value="4" th:selected="${numberOfPeople == 4}">4</option>
					<option value="5" th:selected="${numberOfPeople == 5}">5</option>
					<option value="6" th:selected="${numberOfPeople == 6}">6</option>
				</select>
			</td>
		</tr>
		
		<tr th:if="${pref} != null">
			<th>価格</th>
			<td>
				<select name="priceRange" th:value="${priceRange}">
					<th:block>
						<option value="">価格帯を選択</option>
						<option value="5000-10000" th:selected="${priceRange == '5000-10000'}">5000 ~ 10000</option>
						<option value="10001-15000" th:selected="${priceRange == '10001-15000'}">10001 ~ 15000</option>
						<option value="15001-20000" th:selected="${priceRange == '15001-20000'}">15001 ~ 20000</option>
						<option value="20001-25000" th:selected="${priceRange == '20001-25000'}">20001 ~ 25000</option>
						<option value="25001-30000" th:selected="${priceRange == '25001-30000'}">25001 ~ 30000</option>
						<option value="30001-40000" th:selected="${priceRange == '30001-40000'}">30001 ~ 40000</option>
						<option value="40001-50000" th:selected="${priceRange == '40001-50000'}">40001 ~ 50000</option>
					</th:block>
				</select>
			</td>
		</tr>
		
		<tr th:if="${pref} != null">
			<th>その他</th>
			<td>
				<input type="text" maxlength="10" name="keyword" th:value="${keyword}">
			</td>
		</tr>
		
	</table>
	
	<input type="submit" value="検索する">
	
	</form>
	
	<!--ホテル一覧の表示-->
	<p th:if="${errorMsg}" th:text="${errorMsg}" style="color: darkred;"></p>
	<div th:if="${pref} != null" th:each="hotel : ${hotelList}">
		<div>
			<img th:src="${hotel.photo}">
			<p>
					<a th:href="@{hotel/detail/{id}(id=${hotel.id})}">
						<h3 th:text="${hotel.name}"></h3>
					</a>
					<h4 th:text="'¥' + ${hotel.price} + '〜'"></h4>
				<p th:text="${hotel.prefecture + ' ' + hotel.city}"></p>
			</p>
		</div>
	</div>

	
	<!--カレンダーの表示制限-->
	<script>
		
	// document：HTML読み込み
	// addEventListener：()のなかを起点
	document.addEventListener('DOMContentLoaded', function () {
		const checkIn = document.getElementById('checkIn');
		const checkOut = document.getElementById('checkOut');

		if (checkIn && checkOut) {
			// ページ読み込み時に checkOut.min を設定
			if (checkIn.value) {
				checkOut.min = checkIn.value;

				// すでに checkOut が checkIn より前なら空にする
				if (checkOut.value && new Date(checkOut.value) <= new Date(checkIn.value)) {
					checkOut.value = '';
				}
			}

			// チェックインが変更されたとき
			checkIn.addEventListener('change', function () {
				if (checkIn.value) {
					checkOut.min = checkIn.value;

					if (checkOut.value && new Date(checkOut.value) <= new Date(checkIn.value)) {
						checkOut.value = '';
					}
				}
			});
		}
	});
	
	
	//	// document：HTML読み込み
	//	// addEventListener：()のなかを起点
	//	document.addEventListener('DOMContentLoaded',function(){
	//		const checkIn = document.getElementById('checkIn');
	//		const checkOut = document.getElementById('checkOut');
	//		
	//		checkIn.addEventListener('change',function(){
	//			const checkInDate = new Date(checkIn.value);
	//			checkOut.min = checkIn.value;
	//			const checkOutDate = new Date(checkOut.value);
	//			
	//			if(checkOutDate <= checkInDate){
	//				checkIn.setDate(checkInDate.getDate()+1);
	//			}
	//		});
	//	});
	
	</script>
	
	
</body>
</html>